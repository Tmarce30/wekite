<% content_for :meta_title, "#{@user.first_name} profile" %>
<div class="user-profile">
  <div class="user-info">
    <div class="user-photo text-center">
      <% if @user.facebook_picture_url? %>
        <%= image_tag @user.facebook_picture_url %>
        <% elsif @user.avatar %>
        <%= cl_image_tag @user.avatar.path %>
        <% else %>
        <%= image_tag "http://placehold.it/30x30" %>
      <% end %>
    </div>
      <div class="user-identity text-center">
        <strong><%= current_user.first_name %></strong>
      </div>

  </div>
<div id="map" style="width: 100%; height: 400px;"></div>
<% if @user.pictures.any? %>
<h2><%= @user.first_name %>' photos</h2>
  <div class="user-photos">
    <div class="row">
      <% @user.pictures.each do |picture| %>
        <div class="col-xs-12 col-sm-4 user-spot-photos">
          <p><%= Spot.find(picture.spot_id).name %></p>
          <%# link_to photo_path(photo) do %>
          <% picture.photos.each do |photo|%>
            <%= cl_image_tag photo.path %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
  <% end %>
</div>

  <% content_for(:after_js) do %>
    <%= javascript_tag do %>

      function initMap() {
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 2,
          center: {lat: <%= 0 %>, lng: <%= 0 %>},
          mapTypeId: google.maps.MapTypeId.TERRAIN
        });

        <% current_user.checkins.each do |checkin| %>
          <% if checkin.spot %>
            var marker = new google.maps.Marker({
            position: <%= raw( { lat: checkin.spot.latitude, lng: checkin.spot.longitude }.to_json) %>,
            map: map,
            title: 'Hello World!',
            });
          <% end %>
        <% end %>
      }

      $(document).ready(function() {
        initMap()
      });


    <% end %>
<% end %>
